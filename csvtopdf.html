<head> </head>
<body>
  <form id="myForm">
    <input type="file" id="csvFile" accept=".csv,.xls,.xlxs" />
    <br />
    <input type="submit" value="Submit" />
  </form>
  <div id="element-to-print">
        fafafaf
  </div>
  <button onclick="downloadPdf()">click me</button>

    <div style="margin-top:100px">
        Select a file: <input type="file" id="myFile">
        <button onclick='processFile()'>Process</button>
        <table id="myTable"></table>
    </div>


  <script src="jquery.min.js"></script>
  <script src="html2pdf.bundle.min.js"></script>

  <script>
    const myForm = document.getElementById("myForm");
    const csvFile = document.getElementById("csvFile");

    myForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const input = csvFile.files[0];
      const reader = new FileReader();

      reader.onload = function (e) {
        const text = e.target.result;
        document.write(text);
        console.log(text);
      };

      console.log(reader.result);


      //reader.readAsText(input);
    });
  </script>

    <script type="text/javascript">
        function downloadPdf() {
            $('#element-to-print').text('dfadfa dfasfdafa dfasfafsaf fadfasfsa dfadfasfasdf dfadfasdf asdfasfd fdasfd');
            var element = document.getElementById('element-to-print');
            var opt = {
                margin:       1,
                filename:     'myfile.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2 },
                jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
            };

            // New Promise-based usage:
            html2pdf().set(opt).from(element).save();

            // Old monolithic-style usage:
            html2pdf(element, opt);
        }

    </script>

    <script>
        function processFile() {
            var fileSize = 0;
            //get file
            var theFile = document.getElementById("myFile");
            
             var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/;
             //check if file is CSV
             if (regex.test(theFile.value.toLowerCase())) {
             //check if browser support FileReader
                if (typeof (FileReader) != "undefined") {
               //get table element
                var table = document.getElementById("myTable");
                var headerLine = "";
                //create html5 file reader object
                var myReader = new FileReader();
                // call filereader. onload function
                myReader.onload = function(e) {
                    var content = myReader.result;

                    console.log('content', content);
                    //split csv file using "\n" for new line ( each row)
                    var lines = content.split("\r");
                    //loop all rows
                    for (var count = 0; count < lines.length; count++) {
                        //create a tr element
                        var row = document.createElement("tr");
                        //split each row content
                        var rowContent = lines[count].split(",");
                        //loop throw all columns of a row
                        for (var i = 0; i < rowContent.length; i++) {
                           //create td element 
                            var cellElement = document.createElement("td");
                            if (count == 0) {
                                cellElement = document.createElement("th");
                            } else {
                                cellElement = document.createElement("td");
                            }
                            //add a row element as a node for table
                            var cellContent = document.createTextNode(rowContent[i]);
                            
                            cellElement.appendChild(cellContent);
                            //append row child
                            row.appendChild(cellElement);
                        }
                        //append table contents
                        myTable.appendChild(row);
                    }
                }
                 //call file reader onload
                  myReader.readAsText(theFile.files[0]);
                }
                else 
                {
                      alert("This browser does not support HTML5.");
                }
                
            }
            else {
                        alert("Please upload a valid CSV file.");
            }
            return false;
        }
    </script>
</body>

